
name: ella-core-k8s
type: charm
title: Ella Core (K8s)
summary: A secure, reliable, and easy to operate mobile core network.

description: A secure, reliable, and easy to operate mobile core network.
links:
  source:
    - https://github.com/yeastengine/ella-k8s-operator
  issues:
    - https://github.com/canonical/ella-k8s-operator/issues
  documentation: https://discourse.charmhub.io/t/ella-operator-kubernetes/15386

bases:
  - build-on:
    - name: ubuntu
      channel: "22.04"
    run-on:
    - name: ubuntu
      channel: "22.04"

parts:
  charm:
    build-packages:
      - cargo
      - rustc

containers:
  core:
    resource: core-image
    mounts:
      - storage: config
        location: /etc/core
      - storage: database
        location: /var/lib/core

resources:
  core-image:
    type: oci-image
    description: OCI image for Ella Core.
    upstream-source: ghcr.io/ellanetworks/core:0.0.4

storage:
  config:
    type: filesystem
    minimum-size: 1M
  database:
    type: filesystem
    minimum-size: 1G

config:
  options:
    n3-interface:
      type: string
      default: "n3"
      description: Network interface handling N3 (GTP) traffic. Ella Core attaches an XDP hook to this interface.
    n6-interface:
      type: string
      default: "n6"
      description: Network interface handling N6 (SGi) traffic. Ella Core attaches an XDP hook to this interface.
    logging-level:
      type: string
      default: debug
      description: Logging level.
    gnb-subnet:
      type: string
      default: 192.168.251.0/24
      description: gNodeB subnet.
    n6-ip:
      type: string
      default: 192.168.250.3
      description: IP address used by the Ella's Core interface.
    n6-gateway-ip:
      type: string
      default: 192.168.250.1
      description: Gateway IP address to the Core Network.
    n3-ip:
      type: string
      default: 192.168.252.3
      description: IP address used by the Ella's Access interface.
    n3-gateway-ip:
      type: string
      default: 192.168.252.1
      description: Gateway IP address to the Access Network.

requires:
  fiveg_gnb_identity:
    interface: fiveg_gnb_identity

provides:
  fiveg-n2:
    interface: fiveg_n2
  metrics-endpoint:
    interface: prometheus_scrape
