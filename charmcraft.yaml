
name: ella-k8s
type: charm
title: Ella (K8s)
summary: A private mobile network.

description: A private mobile network.
links:
  source:
    - https://github.com/yeastengine/ella-k8s-operator
  issues:
    - https://github.com/canonical/ella-k8s-operator/issues
  documentation: https://discourse.charmhub.io/t/ella-operator-kubernetes/15386

base: ubuntu@24.04
platforms:
  amd64:
  arm64:

parts:
  charm:
    source: .
    charm-requirements:
      - requirements.txt
    plugin: charm
    build-packages:
      - libffi-dev
      - libssl-dev
      - pkg-config
    build-snaps:
      - astral-uv
      - rustup
    override-build: |
      rustup default stable
      uv export --frozen --no-dev -o requirements.txt
      craftctl default

containers:
  ella:
    resource: ella-image
    mounts:
      - storage: config
        location: /etc/ella

resources:
  ella-image:
    type: oci-image
    description: OCI image for ella
    upstream-source: ghcr.io/ellanetworks/ella-core:v0.0.12

storage:
  config:
    type: filesystem
    minimum-size: 1M

config:
  options:
    logging-level:
      type: string
      default: debug
      description: Logging level.
    gnb-subnet:
      type: string
      default: 192.168.251.0/24
      description: gNodeB subnet.
    n6-ip:
      type: string
      default: 192.168.250.3
      description: IP address used by the Ella's Core interface.
    n6-gateway-ip:
      type: string
      default: 192.168.250.1
      description: Gateway IP address to the Core Network.
    n3-ip:
      type: string
      default: 192.168.252.3
      description: IP address used by the Ella's Access interface.
    n3-gateway-ip:
      type: string
      default: 192.168.252.1
      description: Gateway IP address to the Access Network.

provides:
  metrics-endpoint:
    interface: prometheus_scrape
